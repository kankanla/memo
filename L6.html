<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- https://hakuhin.jp/js/xmlhttprequest.html -->

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta http-equiv="Content-Script-Type" content="text/javascript">
    <title>xxx</title>
</head>

<body>
    <script type="text/javascript">
        function setCSV() {
            var req = new XMLHttpRequest();
            req.onreadystatechange = function () {
                if (req.readyState == 4 && req.status == 200) {
                    vvv(req.responseText);
                }
            }
            req.open("GET", '/loto6.csv', true);
            req.send(null);
        }
        setCSV();

        function vvv(str) {
            let tr = str.split('\n');
            let ttable = document.getElementsByTagName('tbody')[0];
            let ttfe = ttable.firstElementChild;
            do {
                let tr_data = tr.shift();
                let td_data = tr_data.split(',');
                let ircc = ttfe.cloneNode(true);
                let tr_place = ircc.getElementsByTagName('td');
                for (let i = 0; i <= 11; ++i) {
                    if (i <= 1 || i >= 9) {
                        tr_place[i].innerText = td_data[i];
                    } else {
                        tr_place[i].innerText = parseInt(td_data[i]);
                    }
                }
                ttable.insertBefore(ircc, ttfe);
            } while (tr != '');
            master();
        }

        function master() {
            // すべての抽選数字をarrayに取得
            l6ms = [];
            let li = 0;
            let tb = document.getElementsByTagName('tbody')[0];
            let fc = tb.firstElementChild;
            do {
                l6ms[li] = [];
                let da = fc.getElementsByTagName('td');
                if (da.length > 7) {
                    for (let i = 2; i < 9; i++) {
                        l6ms[li].push(parseInt(da[i].innerText));
                    }
                    li++;
                }
            } while (fc = fc.nextElementSibling);
            return l6ms;
        }

        function cc() {
            let fincol = document.getElementsByClassName('setColor');
            for (let i = 0; i < fincol.length; i++) {
                fincol[i].removeAttribute('style');
            }

        }

        function fns62(tx6, set3 = 160) {
            let test = l6ms;
            let vx = 0;
            let contA = 0;
            let contB = 0;
            for (let i = 0; i < test.length; i++) {
                contA = 0;
                for (let j = 0; j < tx6.length; j++) {
                    if (test[i].indexOf(tx6[j]) != -1) {
                        contA++;
                    }
                }
                if (contA >= 3) {
                    contB++;
                }
            }
            if (contB >= set3) {
                console.log('fns6(  [' + tx6 + ']  )' + "  d3c = " + contB);
            }
        }

        function ck62(tx6, set3 = 150) {
            // fns6([6, 10, 20, 22, 27, 28, 33])  d3c = 162
            console.log(new Date());
            ck62_work = setInterval(function () {
                for (let i = 0; i < 1000; i++) {
                    let temp = l6(7);
                    fns62(temp, set3);
                    if (tx6-- == 0) {
                        clearInterval(ck62_work);
                        console.log(new Date());
                        console.log('ck62_work_end');
                    }
                }
            }, 1);
        }

        function fns6(tx6, set1 = 0, set2 = 0, set3 = 100) {
            // console.log('tx6 =  ' + tx6);
            let colors = ['#FF6666', '#99CC66', '#33FFCC', '#CC66CC', '#FFFF00', '#FF33CC', '#FF6600', '#99FF00', '#CC66CC'];
            let tb = document.getElementsByTagName('tbody')[0];
            let fc = tb.firstElementChild;
            let xca = 0;
            cc();

            do {
                let trs = fc.getElementsByTagName('td');
                if (trs.length < 3) {
                    break;
                }
                let xc = 0;

                for (let i = 2; i < 9; i++) {
                    for (let j = 0; j < tx6.length; j++) {
                        if (trs[i].innerText == tx6[j]) {
                            trs[i].style.backgroundColor = colors[j];
                            trs[i].setAttribute('class', 'setColor');
                            xc++;
                            if (set1 == 1) {
                                tx6.splice(j, 1);
                                master();
                            }
                        }
                    }
                }

                if (xc == 3) {
                    trs[0].style.backgroundColor = colors[0];
                    trs[0].setAttribute('class', 'setColor');
                    xca++;
                }

                if (xc == 4) {
                    trs[0].style.backgroundColor = colors[1];
                    trs[0].setAttribute('class', 'setColor');
                    xca++;
                }

                if (xc == 5) {
                    trs[0].style.backgroundColor = colors[2];
                    trs[0].setAttribute('class', 'setColor');
                    xca++;
                }
            } while (fc = fc.nextElementSibling);

            if (xca >= set3) {
                console.log('fns6(  [' + tx6 + ']  )' + "  d3c = " + xca);
            }
        }


        function ck6(tx6) {
            ck6_work = setInterval(function () {
                let temp = l6(7);
                if (tx6 == 1) {
                    console.log('fns6( [' + temp + '] )');
                }
                fns6(temp);
                if (tx6-- == 0) {
                    clearInterval(ck6_work);
                    console.log('ck6_work_end');
                }
            }, 1);
        }

        function l6(tx6 = 6) {
            // ランダムの数字を発生
            // console.log('tx6 =  ' + tx6);
            var j = [];
            do {
                var c = Math.floor(Math.random() * (1 - 66) + 66);
                if (c <= 43) {
                    if (j.indexOf(c) == -1) {
                        j.push(c);
                    }
                }
            } while (j.length < tx6);
            return j.sort((a, b) => a - b);
        }


        window.onload = function () {

        }

    </script>
    <table table border="1" cellspacing="0" cellpadding="1" bordercolor="#333333">
        <tr align="right">
            <td>0</td>
            <td>2000/10/5</td>
            <td>100</td>
            <td>100</td>
            <td>100</td>
            <td>100</td>
            <td>100</td>
            <td>100</td>
            <td>100</td>
            <td>100</td>
            <td>0円</td>
            <td>0円</td>
        </tr>
    </table>

</body>

</html>